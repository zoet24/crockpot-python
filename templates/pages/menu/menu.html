{% set active_page = 'menu' %}
{% extends "pages/base/base.html" %}

{% block extra_title %} | Menu{% endblock %}

{% block content %}
    <!-- Header -->
    {% with header_text="Menu" %}
        {% include 'components/header.html' %}
    {% endwith %}

    <section class="menu">
        <div class="menu__container">
            <div class="toggle-box toggle-box--no-border">
                <div class="toggle-box__container">
                    <div class="toggle toggle--rounded toggle--border toggle-box__toggle">
                        <input class="toggle__input toggle__input--1" type="radio" name="toggle__MenuShopping" id="toggle__MenuShopping__Menu" checked="checked">
                        <label class="toggle__option toggle__option--1" for="toggle__MenuShopping__Menu">Menu</label>
                        <input class="toggle__input toggle__input--2" type="radio" name="toggle__MenuShopping" id="toggle__MenuShopping__Shopping">
                        <label class="toggle__option toggle__option--2" for="toggle__MenuShopping__Shopping">Shopping List</label>
                        <span class="toggle__slider"></span>
                    </div>
                    <div class="toggle-box__box toggle-box__box--py-0">
                        <div class="toggle-box__box-left">
                            <!-- Show recipes on menu -->
                            {% for menuRec in menuRecs %}
                                <div class="menu__item">
                                    <div class="menu__item-image-wrapper">
                                        <a href="/viewRecipe/{{menuRec[0]}}">
                                            <div class="menu__item-image">
                                                <img src="{{ menuRec[2] }}" alt="">
                                            </div>
                                        </a>
                                    </div>
                                    <div class="menu__item-content-wrapper">
                                        <a href="/viewRecipe/{{menuRec[0]}}" class="menu__item-name-wrapper">
                                            <div class="menu__item-name">
                                                <h2>{{ menuRec[1] }}</h2>
                                            </div>
                                        </a>
                                        <div class="menu__item-icons">
                                            <div class="menu__item-serving">
                                                {% with btn_start=menuRec[3], btn_step="1", btn_min="1", btn_max="20" %}
                                                    {% include 'components/btn-plus-minus.html' %}
                                                {% endwith %}
                                            </div>
                                            <form class="recipe-image__link-wrapper" action="/menu/{{menuRec[0]}}">
                                                <button class="btn-submit" type="submit">
                                                    <i class="fas fa-utensils icon"></i>
                                                </button>
                                            </form>
                                            <form class="recipe-image__link-wrapper" action="/fav/{{menuRec[0]}}">
                                                <button class="btn-submit" type="submit">
                                                    <i class="fas fa-heart icon"></i>
                                                </button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                        <div class="toggle-box__box-right hide">
                            <div class="accordion">
                                <!-- Accordion item - change id and for -->
                                <div class="accordion__button">
                                  <input type="checkbox" id="accordion__button-1">
                                  <label class="accordion__button-label" for="accordion__button-1">
                                    <span>
                                      <i class="fas fa-drumstick-bite icon icon--no-ml"></i>
                                      Meat ({{ ingCatsCount["Meat"] }})
                                    </span>
                                  </label>
                                  <div class="accordion__content">
                                    <ul>
                                        {% for ings in shoppingList %}
                                            {% if ings[1] == "Meat" %}
                                                <li>{{ ings[0] }} x <span class="targetNum">{{ ings[2] }}</span>{{ ings[3] }}</li>
                                            {% endif %}
                                        {% endfor %}
                                    </ul>
                                  </div>
                                </div>
                                <!-- Accordion item - change id and for -->
                                <div class="accordion__button">
                                  <input type="checkbox" id="accordion__button-2">
                                  <label class="accordion__button-label" for="accordion__button-2">
                                    <span>
                                      <i class="fas fa-fish icon icon--no-ml"></i>
                                      Fish ({{ ingCatsCount["Fish"] }})
                                    </span>
                                  </label>
                                  <div class="accordion__content">
                                    <ul>
                                        {% for ings in shoppingList %}
                                            {% if ings[1] == "Fish" %}
                                                <li>{{ ings[0] }} x <span class="targetNum">{{ ings[2] }}</span>{{ ings[3] }}</li>
                                            {% endif %}
                                        {% endfor %}
                                    </ul>
                                  </div>
                                </div>
                                <!-- Accordion item - change id and for -->
                                <div class="accordion__button">
                                  <input type="checkbox" id="accordion__button-3">
                                  <label class="accordion__button-label" for="accordion__button-3">
                                    <span>
                                      <i class="fas fa-lemon icon icon--no-ml"></i>
                                      Fruit ({{ ingCatsCount["Fruit"] }})
                                    </span>
                                  </label>
                                  <div class="accordion__content">
                                    <ul>
                                        {% for ings in shoppingList %}
                                            {% if ings[1] == "Fruit" %}
                                                <li>{{ ings[0] }} x <span class="targetNum">{{ ings[2] }}</span>{{ ings[3] }}</li>
                                            {% endif %}
                                        {% endfor %}
                                    </ul>
                                  </div>
                                </div>
                                <!-- Accordion item - change id and for -->
                                <div class="accordion__button">
                                  <input type="checkbox" id="accordion__button-4">
                                  <label class="accordion__button-label" for="accordion__button-4">
                                    <span>
                                      <i class="fas fa-carrot icon icon--no-ml"></i>
                                      Veg ({{ ingCatsCount["Veg"] }})
                                    </span>
                                  </label>
                                  <div class="accordion__content">
                                    <ul>
                                        {% for ings in shoppingList %}
                                            {% if ings[1] == "Veg" %}
                                                <li>{{ ings[0] }} x <span class="targetNum">{{ ings[2] }}</span>{{ ings[3] }}</li>
                                            {% endif %}
                                        {% endfor %}
                                    </ul>
                                  </div>
                                </div>
                                <!-- Accordion item - change id and for -->
                                <div class="accordion__button">
                                  <input type="checkbox" id="accordion__button-5">
                                  <label class="accordion__button-label" for="accordion__button-5">
                                    <span>
                                      <i class="fas fa-cheese icon icon--no-ml"></i>
                                      Dairy ({{ ingCatsCount["Dairy"] }})
                                    </span>
                                  </label>
                                  <div class="accordion__content">
                                    <ul>
                                        {% for ings in shoppingList %}
                                            {% if ings[1] == "Dairy" %}
                                                <li>{{ ings[0] }} x <span class="targetNum">{{ ings[2] }}</span>{{ ings[3] }}</li>
                                            {% endif %}
                                        {% endfor %}
                                    </ul>
                                  </div>
                                </div>
                                <!-- Accordion item - change id and for -->
                                <div class="accordion__button">
                                  <input type="checkbox" id="accordion__button-6">
                                  <label class="accordion__button-label" for="accordion__button-6">
                                    <span>
                                      <i class="fas fa-bread-slice icon icon--no-ml"></i>
                                      Cupboard ({{ ingCatsCount["Cupboard"] }})
                                    </span>
                                  </label>
                                  <div class="accordion__content">
                                    <ul>
                                        {% for ings in shoppingList %}
                                            {% if ings[1] == "Cupboard" %}
                                                <li>{{ ings[0] }} x <span class="targetNum">{{ ings[2] }}</span>{{ ings[3] }}</li>
                                            {% endif %}
                                        {% endfor %}
                                    </ul>
                                  </div>
                                </div>
                                <!-- Accordion item - change id and for -->
                                <div class="accordion__button">
                                  <input type="checkbox" id="accordion__button-7">
                                  <label class="accordion__button-label" for="accordion__button-7">
                                    <span>
                                      <i class="fas fa-pepper-hot icon icon--no-ml"></i>
                                      Herbs and Spices ({{ ingCatsCount["Herbs and Spices"] }})
                                    </span>
                                  </label>
                                  <div class="accordion__content">
                                    <ul>
                                        {% for ings in shoppingList %}
                                            {% if ings[1] == "Herbs and Spices" %}
                                                <li>{{ ings[0] }} x <span class="targetNum">{{ ings[2] }}</span>{{ ings[3] }}</li>
                                            {% endif %}
                                        {% endfor %}
                                    </ul>
                                  </div>
                                </div>
                                <!-- Accordion item - change id and for -->
                                <div class="accordion__button">
                                  <input type="checkbox" id="accordion__button-8">
                                  <label class="accordion__button-label" for="accordion__button-8">
                                    <span>
                                      <i class="fas fa-cookie-bite icon icon--no-ml"></i>
                                      Sweets ({{ ingCatsCount["Sweets"] }})
                                    </span>
                                  </label>
                                  <div class="accordion__content">
                                    <ul>
                                        {% for ings in shoppingList %}
                                            {% if ings[1] == "Sweets" %}
                                                <li>{{ ings[0] }} x <span class="targetNum">{{ ings[2] }}</span>{{ ings[3] }}</li>
                                            {% endif %}
                                        {% endfor %}
                                    </ul>
                                  </div>
                                </div>
                                <!-- Accordion item - change id and for -->
                                <div class="accordion__button">
                                  <input type="checkbox" id="accordion__button-9">
                                  <label class="accordion__button-label" for="accordion__button-9">
                                    <span>
                                      <i class="fas fa-toilet-paper icon icon--no-ml"></i>
                                      House ({{ ingCatsCount["House"] }})
                                    </span>
                                  </label>
                                  <div class="accordion__content">
                                    <ul>
                                        {% for ings in shoppingList %}
                                            {% if ings[1] == "House" %}
                                            <li>{{ ings[0] }} x <span class="targetNum">{{ ings[2] }}</span>{{ ings[3] }}</li>
                                            {% endif %}
                                        {% endfor %}
                                    </ul>
                                  </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Update menu button -->
    <div class="menu__fixed-btns">
        <form method="POST" action="{{ url_for('updateMenu') }}">
            <div class="hide">
                {% for menuRec in menuRecs %}
                    <input type="text" name="id-{{loop.index}}" value="{{ menuRec[0] }}">
                    <input type="number" name="serves-{{loop.index}}" class="menu__item-serving-val">
                {% endfor %}
            </div>
            <div class="btn">
                <input type="submit" value="Update menu">
            </div>
        </form>
        <div class="modal__buttons modal__buttons--clear-menu modal__button--open--clear-menu btn">
            Clear menu
        </div>
    </div>

    <!-- Are you sure you want to clear menu? modal (put identifier on modal, modal__buttons, modal__button--open and modal__button--close )-->
    <div class="modal modal--clear-menu hide">
        <div class="modal__container">
            <div class="modal__content">
                <div class="modal__text">
                    <form class="form form--center" method="POST" action="{{ url_for('clearMenu') }}">
                        <h4>Are you sure you want to clear your menu?</h4>
                        <div class="modal__buttons modal__buttons--clear-menu">
                            <div class="modal__button modal__button--yes btn btn--sm">
                                <input class="" type="submit" value="Yes">
                            </div>
                            <div class="btn btn--sm modal__button modal__button--close modal__button--close--clear-menu">
                                No
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        // If on the same page as view recipe, change quantity of food
        window.addEventListener('load', (e) => {
            const targetNums = document.querySelectorAll('.targetNum');

            for (var i = 0; i < targetNums.length; i++) {
                var targetNum = targetNums[i];

                if (targetNum.innerHTML.includes('.')) {
                    if (targetNum.innerHTML.slice(-1) == "0") {
                        targetNum.innerHTML -= "0"
                    }
                }
            }
        });
    </script>

    {% include 'pages/menu/includes/js-updateMenu.html' %}
{% endblock %}